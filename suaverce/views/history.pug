extends layout

block content
  div(class="container mx-auto px-4 py-6")
    h1(class="text-2xl font-bold mb-6 text-yt-light-text dark:text-yt-dark-text") Watch History
    
    if watchHistory && watchHistory.length > 0
      div(class="flex flex-col space-y-4")
        each item in watchHistory
          a(href=`/anime/${item.animeSlug}/episode/${item.episodeNumber}` class="group flex flex-col sm:flex-row bg-yt-white dark:bg-yt-dark-gray-1 rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-200")
            // Thumbnail
            div(class="flex-shrink-0 w-full sm:w-40 h-32 sm:h-auto overflow-hidden")
              img(src=item.animePoster alt=item.animeTitle class="w-full h-full object-cover" onerror="this.onerror=null;this.src='https://placehold.co/160x90?text=No+Image';")
            
            // Details
            div(class="flex-1 p-4")
              h3(class="text-lg font-semibold text-yt-light-text dark:text-yt-dark-text line-clamp-2 group-hover:text-yt-red")= item.animeTitle
              p(class="text-sm text-gray-600 dark:text-gray-400 mt-1") Episode #{item.episodeNumber}
              p(class="text-xs text-gray-500 dark:text-gray-500 mt-1") Last watched: #{new Date(item.updatedAt).toLocaleString()}
              if item.timestampSeconds > 0
                div(class="w-full bg-gray-200 rounded-full h-1 mt-2")
                  div(class="bg-yt-red h-1 rounded-full" style=`width: ${item.timestampSeconds > 0 ? (item.timestampSeconds / (item.totalDuration || 1)) * 100 : 0}%`)
    else
      div(class="text-center py-16")
        p(class="text-gray-600 dark:text-gray-400") Anda belum memiliki riwayat tontonan.
